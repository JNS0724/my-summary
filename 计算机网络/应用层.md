# 应用层

## HTTP

### get和Post的区别

* get的参数放在url里面、post的参数放在请求体里面
* get请求会被游览器缓存、post请求不会缓存
* get请求只响应一次、游览器把HTTP header和data一起发送出去、服务器相应200、post相应两次，游览器先发送header,服务器相应100continue,游览器再发送data、服务器相应200。

<https://github.com/febobo/web-interview/issues/145>

### HTTP状态码

|状态码| 类别 |原因短语|
|---|---|---|
|1XX |Informational(信息性状态码) |接收的请求正在处理 |
|2XX |Success(成功状态码) |请求正常处理完毕 |
|3XX |Redirection(重定向状态码) |需要进行附加操作以完成请求 |
|4XX |Client Error(客户端错误状态码) |服务器无法处理请求 |
|5XX |Server Error(服务器错误状态码) |服务器处理请求出错|

### cookie

Cookie HTTP 协议是无状态的，主要是为了让 HTTP 协议尽可能简单，使得它能够处理大量事务。HTTP/1.1 引入 Cookie 来保存状态信息。 Cookie 是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器之后向同一服务器再次发起请求时被携带上，用于告知服务端两个请求是否来自同一浏览器。由于之后每次请求都会需要携带 Cookie 数据，因此会带来额外的性能开销(尤其是在移动环境下)。

### session

除了可以将用户信息通过 Cookie 存储在用户浏览器中，也可以利用 Session 存储在服务器端，存储在服务器端的信息更加安全。 Session 可以存储在服务器上的文件、数据库或者内存中。也可以将 Session 存储在 Redis 这种内存型数据库中，效率会更高。

### HTTPS

HTTPs 并不是新协议，而是让 HTTP 先和 SSL(Secure Sockets Layer)通信，再由 SSL 和 TCP 通信，也就是说 HTTPs 使用了隧道进行通信。

## DNS解析

1、本地客户机提出域名解析请求，查找本地HOST文件后将该请求发送给本地的域名服务器。
2、将请求发送给本地的域名服务器。
3、当本地的域名服务器收到请求后，就先查询本地的缓存。
4、如果有该纪录项，则本地的域名服务器就直接把查询的结果返回浏览器。
5、如果本地DNS缓存中没有该纪录，则本地域名服务器就直接把请求发给根域名服务器。
6、然后根域名服务器再返回给本地域名服务器一个所查询域（根的子域）的主域名服务器的地址。
7、本地服务器再向上一步返回的域名服务器发送请求，然后接受请求的服务器查询自己的缓存，如果没有该纪录，则返回相关的下级的域名服务器的地址。
8、重复第7步，直到找到正确的纪录。
9、本地域名服务器把返回的结果保存到缓存，以备下一次使用，同时还将结果返回给客户机。

递归查询：主机向本地域名服务器的查询一般都是采用递归查询。如果主机所询问的本地域名服务器不知道被查询的域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，向其它根域名服务器继续发出查询请求报文(即替主机继续查询)，而不是让主机自己进行下一步查询。因此，递归查询返回的查询结果或者是所要查询的 IP 地址，或者是报错，表示无法查询到所需的 IP 地址。

迭代查询：一般DNS服务器之间属迭代查询，如：若 DNS2 不能响应 DNS1 的请求，则它会将 DNS3 的 IP 给 DNS2，以便其再向 DNS3 发出请求。

## Https

在传输层和应用层之间，增加了TLS和SSL的握手和协商加密协议。

在这里分为非对称加密和对称加密，服务器先给客户端发送公钥和数字证书，客户端通过数字证书对公钥进行一些hash操作，验证是否于数字证书中的数字签名一致，如果一致则公钥认证通过。然后客户端自己会生成一个密钥，用公钥加密自己的密钥发到服务端，服务端用私钥解锁公钥获得密钥。后面的通信全都采用密钥。

总结：非对称加密里套了一层对称加密。

## HTTP1.1

比起Http1.0

1.增加了keep-alive属性，保持了tcp长连接，多个请求可以复用一个连接。

对于一个域名，浏览器最多可以开启4到6个长连接，不同浏览器限制不同。

2.用流模式取代了缓存模式。

3.新增了PUT、DELETE等请求方式。

缺点：多个请求排队，会有阻塞的情况

## HTTP2.0

二进制分帧层，可以将报文转换为二进制。

多路复用，1.1可以并行发送请求，但返回响应结果必须是发送的顺序。多路复用的基础是二进制分帧，可以乱序发送和接收。

多路复用的实现基于二进制帧和流的概念，即把有数据依赖的分到一个流里，不同流互相不影响。

首部压缩：维护一张静态表和动态表，静态表是常见的头部，动态表是变化的首部信息。

## HTTP3.0

由于http2.0基于tcp，tcp数据包丢失时会阻碍滑动窗口移动。

递增的序号，通过偏移来组装报文。每个请求使用一个滑动窗口，单个丢包时不影响其他stream。

两级流量控制：connection规定所有数据流的总窗口大小，stream规定每个流的窗口大小。

应用层的拥塞控制：慢启动、拥塞避免、拥塞发生、快速恢复

前向安全和前向纠错，每当发送一组数据，就对其进行异或操作，将结果发送到对端进行比对，可以对初始数据进行纠错和校验。

## DHCP协议

端口67 68

* 主机通过广播查找DHCP服务器。
* DCHP服务器收到后，会分配一个IP地址，并广播。
* 主机收到DHCP广播的报文后，单播DHCP服务器。
* DHCP回应主机，缓存主机信息。

DCHP可以认为是基于UDP的应用层协议，但本质是为了寻求新主机的动态ip地址。