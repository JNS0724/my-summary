# 一致性与共识 linearizability

CAP理论中的 ***C*** 强一致性strong consistency

## 最终一致性

写入数据后等待一段不确定的时间，那么所有的读取请求都会返回相同的值。

非常弱的保证，不能确保什么时候副本能够收敛

一致性和事务隔离的区别在于，分布式一致性主要关于面对延迟和故障时，如何协调副本间的状态。

## 线性一致性 强一致性

常用的最强一致性模型。

使系统看起来只有一个副本，因为多副本就意味着可能有多个不一致的状态，不能保证两次读取都是新值。
系统保障了所有请求读到的值是最新的值。

解决方案就是：增加约束，让第一次读取之后的后续读取也要是新值。

### 可串行化

可串行化（Serializability） 是事务的隔离属性，每个事务可以读写多个对象（行，文档，记录）它确保事务的行为，与它们按照某种顺序依次执行的结果相同（每个事务在下一个事务开始之前运行完成）。这种执行顺序可以与事务实际执行的顺序不同。

线性一致性（Linearizability） 是读取和写入寄存器（单个对象）的 新鲜度保证。它不会将操作组合为事务，因此它也不会阻止写入偏差等问题。

基于两阶段锁定的可串行化实现，通常是线性一致性的。但MVCC就不是线性一致性的。

一个数据库可以提供可串行化和线性一致性，这种组合被称为严格的可串行化或 强的单副本可串行化（strong-1SR）

跟可序列化不同，也就是我们不能强规定读写的顺序序列化，但保证读写的版本是最新的。

在分布式系统文献中，这个接收请求返回数据的称为寄存器。

如果读取（与写入同时发生时）可能返回旧值或新值，则称该寄存器为 常规寄存器（regular register）

### 线性一致性的作用

* 分布式选主，防止脑裂。
