# 操作系统

## cpu架构

* x86

    Intel的x86架构，CISC复杂指令集，优点就是性能比较强。使用桥的方式和IO设备进行连接。

* MIPS
* ARM

    精简指令集（RISC）处理器架构，其广泛地使用在许多嵌入式系统设计。优点就是低能耗。

* RISC-V

## 常用寄存器

通用寄存器、段寄存器、标志寄存器、指令寄存器

标志寄存器；进位、奇偶、零、补码之类的，记录了CPU执行指令过程中的一系列状态

***指令寄存器***EIP(x86), RIP(x64)它指向了下一条要执行的指令所存放的地址，CPU的工作其实就是不断取出它指向的指令，然后执行这条指令，同时指令寄存器继续指向下面一条指令

### 通用寄存器

EAX 一般用作累加器
EBX 一般用作基址寄存器(Base)
ECX 一般用来计数(Count)
EDX 一般用作目标变址（Destinatin Index）
EBP 一般用作堆栈指针(tack Pointer)
EBP 一般用作基址指针(Base Pointer)
ESI 一般用作源变址(Source Index)
EDI 一般用作目标变址(Destinatin Index)

x64架构中，上面的通用寄存器都扩展成为64位版本，变成rax rbx rcx rdx rsp rbp rsi rdi

### 段寄存器

实模式存基地址，保护模式存段描述符。

CS 代码段寄存器：指向包含程序指令的段，在CS寄存器中RPL用于表示当前CPU的特权级(CPL)，CPL为0是最高权限(内核态使用)，CPL为3是用户态使用。
SS 栈段寄存器：指向当前程序的栈的段。
DS 数据段寄存器：指向保存着静态数据和全局数据的段(静态区)。

段寄存器里存的是段选择符，用来查找段描述符表中对应段描述符。每个cpu有全局描述符，每个进程可以有局部描述符。多数用户态的liunx程序都不使用局部描述符表，所以linux内核只定义了一个缺省的LDT供大多数进程共享。

linux段描述符里基地址都是0，相当于linux不用分段寻址，段描述符只是用来描述段的信息。

内核进程和用户进程之间切换的时候改段寄存器，用户进程之间切换的时候只是改cr3（页表基地址寄存器），并不改段寄存器。

## 死锁

死锁产生的条件：

1.互斥 只能分配给一个进程
2.禁止抢占 资源不能强制从一个进程中退出
3.持有和等待：一个进程可以在等待时持有系统资源
4.循环等待：相互等待其他进程占有的资源

预防死锁必须破坏其中的一环。
